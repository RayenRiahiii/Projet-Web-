<!-- Calendar Header -->
<div class="calendar-container" #calendarContainer>
  <div class="calendar-header">
    <div class="calendar-title">
      <h2>{{ monthNames[currentDate.getMonth()] }} {{ currentDate.getFullYear() }}</h2>
    </div>
    <div class="calendar-controls">
      <div class="search-container">
        <input 
          type="text" 
          [(ngModel)]="searchTerm" 
          (input)="searchMeetings()" 
          placeholder="Rechercher une réunion..." 
          class="search-input"
        />
      </div>
      <button class="calendar-btn today-btn" (click)="currentMonth()">Aujourd'hui</button>
      <button class="calendar-btn nav-btn" (click)="previousMonth()">
        <i class="fas fa-chevron-left"></i>
      </button>
      <button class="calendar-btn nav-btn" (click)="nextMonth()">
        <i class="fas fa-chevron-right"></i>
      </button>
    </div>
  </div>

  <!-- Calendar Weekdays Header -->
  <div class="calendar-weekdays">
    <div class="weekday" *ngFor="let weekday of weekdays">{{ weekday }}</div>
  </div>

  <!-- Calendar Grid -->
  <div class="calendar-grid" *ngIf="!isLoading">
    <div 
      *ngFor="let day of calendarDays" 
      [ngClass]="getDayClass(day)"
      class="calendar-day"
    >
      <div class="day-header">
        <span class="day-number">{{ day.date.getDate() }}</span>
      </div>
      <div class="day-content">
        <div 
          *ngFor="let meeting of day.meetings" 
          [ngClass]="'meeting-item ' + getStatusClass(meeting.statut)"
          (click)="openMeetingDetails(meeting)"
        >
          <div class="meeting-time">{{ getFormattedTime(meeting.dateHeure) }}</div>
          <div class="meeting-title">{{ meeting.sujet }}</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="isLoading">
    <div class="loading-spinner"></div>
    <p>Chargement des réunions...</p>
  </div>

  <!-- No Meetings Message -->
  <div class="no-meetings" *ngIf="!isLoading && filteredMeetings.length === 0">
    <p>Aucune réunion trouvée pour cette période.</p>
  </div>
</div>

<!-- Meeting Details Modal -->
<div class="modal-overlay details-modal-overlay" *ngIf="showMeetingDetailsModal" (click)="closeMeetingDetailsModal()">
  <div class="modal-content meeting-details-modal" (click)="$event.stopPropagation()">
    <div class="details-header" *ngIf="selectedMeeting">
      <div class="meeting-status-badge" [ngClass]="getStatusClass(selectedMeeting.statut)">
        {{ selectedMeeting.statut === 'A_VENIR' ? 'À venir' : 
          selectedMeeting.statut === 'EN_COURS' ? 'En cours' : 'Terminé' }}
      </div>
      <button class="close-btn" (click)="closeMeetingDetailsModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="details-content" *ngIf="selectedMeeting">
      <div class="details-title-section">
        <h2>{{ selectedMeeting.sujet }}</h2>
        <div class="details-pill reminder-pill" [ngClass]="{'active-reminder': selectedMeeting.rappel}">
          <i class="fas" [ngClass]="selectedMeeting.rappel ? 'fa-bell' : 'fa-bell-slash'"></i>
          <span>{{ selectedMeeting.rappel ? 'Rappel activé' : 'Sans rappel' }}</span>
        </div>
      </div>
      
      <div class="details-info-card">
        <div class="details-row">
          <div class="details-icon-wrap">
            <i class="fas fa-calendar-day"></i>
          </div>
          <div class="details-text">
            <span class="details-label">Date</span>
            <span class="details-value">{{ selectedMeeting.dateHeure | date:'EEEE d MMMM y' }}</span>
          </div>
        </div>
        
        <div class="details-row">
          <div class="details-icon-wrap">
            <i class="fas fa-clock"></i>
          </div>
          <div class="details-text">
            <span class="details-label">Heure</span>
            <span class="details-value">{{ selectedMeeting.dateHeure | date:'HH:mm' }}</span>
          </div>
        </div>
        
        <div class="details-row" *ngIf="selectedMeeting.description">
          <div class="details-icon-wrap">
            <i class="fas fa-align-left"></i>
          </div>
          <div class="details-text">
            <span class="details-label">Description</span>
            <p class="details-description">{{ selectedMeeting.description }}</p>
          </div>
        </div>
        
        <div class="details-row">
          <div class="details-icon-wrap">
            <i class="fas fa-project-diagram"></i>
          </div>
          <div class="details-text">
            <span class="details-label">Projet</span>
            <span class="details-value">{{ getProjectName(selectedMeeting.projetId) }}</span>
          </div>
        </div>
      </div>
      
      <!-- Section des participants -->
      <div class="participants-section" *ngIf="meetingParticipants && meetingParticipants.length > 0">
        <h3 class="participants-title">
          <i class="fas fa-users"></i>
          Participants ({{ meetingParticipants.length }})
        </h3>
        
        <div class="participants-list">
          <div class="participant-card" *ngFor="let participant of meetingParticipants">
            <div class="participant-avatar">
              <span>{{ getInitials(participant.nom) }}</span>
            </div>
            <div class="participant-info">
              <span class="participant-name">{{ participant.nom }}</span>
              <span class="participant-email">{{ participant.email }}</span>
            </div>
          </div>
          
          <div class="no-participants" *ngIf="meetingParticipants.length === 0">
            <p>Aucun participant</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
